<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Szövegátalakító</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .text-box {
            width: 100%;
            min-height: 200px;
            margin-bottom: 20px;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #OutputBox {
            background-color: #f5f5f5;
        }
        .button-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Text Converter</h1>
    
    <div>
        <label for="InputBox">Input:</label>
        <textarea id="InputBox" class="text-box" placeholder="Type your text..."></textarea>
    </div>
    
    <div>
        <label for="OutputBox">Output:</label>
        <textarea id="OutputBox" class="text-box" placeholder="Converted text..." readonly></textarea>
    </div>
    
    <div class="button-container">
        <button onclick="toUpperCase()">UpperCase</button>
        <button onclick="toLowerCase()">LowerCare</button>
        <button onclick="capitalizeFirst()">Start with UpperCase</button>
        <button onclick="reverseText()">Reverse</button>
        <button onclick="stringToStringArray()">String to String Array</button>
        <button onclick="stringArrayToString()">String Array To String</button>
        <button onclick="linebreakToComma()">Linebreak to comma</button>
        <button onclick="linebreakToCommaAddQuoteStr()">Linebreak to comma and add quote string</button>
    </div>

    <div style="display: flex; gap: 20px; margin-top: 30px;">
        <div style="flex: 1;">
            <label for="LB_Functions">Functions</label>
            <select id="LB_Functions" size="8" style="width:100%;" ondblclick="moveSelected('LB_Functions', 'LB_CustomFunction')"></select>
        </div>
        <div style="flex: 1;">
            <label for="LB_CustomFunction">Custom Function</label>
            <select id="LB_CustomFunction" size="8" style="width:100%;" ondblclick="moveSelected('LB_CustomFunction', 'LB_Functions')"></select>
        </div>
    </div>
    <div style="margin-top: 10px; text-align: right;">
        <button onclick="runCustomFunctions()">Run Custom Command</button>
    </div>

    <script>
        // Függvények listája
        const functionMap = {
            toUpperCase: function(input) { return input.toUpperCase(); },
            toLowerCase: function(input) { return input.toLowerCase(); },
            capitalizeFirst: function(input) {
                if (input.length === 0) return '';
                return input.charAt(0).toUpperCase() + input.slice(1).toLowerCase();
            },
            reverseText: function(input) {
                return input.split('').reverse().join('');
            },
            stringToStringArray: function(input) {
                input = input.replace(/`/g, '');
                input = input.replace(/'/g, "''");
                let lines = input.split(/\r?\n/);
                lines = lines.map(line => `'${line}'`);
                for (let i = 0; i < lines.length - 1; i++) {
                    lines[i] = lines[i] + ',';
                }
                return lines.join('\n');
            },
            stringArrayToString: function(input) {
                let lines = input.split(/\r?\n/);
                lines = lines.map(line => line.replace(/,$/, ''));
                lines = lines.map(line => line.replace(/^'+|'+$/g, ''));
                lines = lines.map(line => line.replace(/''/g, "'"));
                return lines.join('\n');
            },
            linebreakToComma: function(input) {
                let lines = input.split(/\r?\n/).map(line => line.trim()).filter(line => line.length > 0);
                return lines.join(',');
            },
            linebreakToCommaAddQuoteStr: function(input) {
                let lines = input.split(/\r?\n/).map(line => line.trim()).filter(line => line.length > 0);
                lines = lines.map(line => `'${line}'`);
                return lines.join(',');
            }
        };

        // Mozgatás egyik listboxból a másikba
        function moveSelected(fromId, toId) {
            const from = document.getElementById(fromId);
            const to = document.getElementById(toId);
            if (from.selectedIndex === -1) return;
            const selected = Array.from(from.selectedOptions);
            selected.forEach(option => {
                from.removeChild(option);
                to.appendChild(option);
            });
            // Ha visszarakunk az LB_Functions-be, akkor csak azt rendezzük, ami benne van
            if (toId === 'LB_Functions') {
                sortLBFunctions();
            }
        }

        // Új rendező függvény csak az LB_Functions aktuális elemeire
        function sortLBFunctions() {
            const lbFunctions = document.getElementById('LB_Functions');
            let options = Array.from(lbFunctions.options).map(opt => ({
                value: opt.value,
                text: opt.text
            }));
            options.sort((a, b) => a.text.localeCompare(b.text));
            lbFunctions.innerHTML = '';
            options.forEach(option => {
                let opt = document.createElement('option');
                opt.value = option.value;
                opt.text = option.text;
                lbFunctions.appendChild(opt);
            });
        }

        // Listboxok feltöltése
        window.onload = function() {
            fillFunctionsListbox();
        };

        function fillFunctionsListbox() {
            const lbFunctions = document.getElementById('LB_Functions');
            // Csak akkor töltsük fel, ha üres (ne írjuk felül a visszarakott elemeket)
            if (lbFunctions.options.length === 0) {
                let options = [];
                Object.keys(functionMap).forEach(fn => {
                    options.push({ value: fn, text: fn });
                });
                options.sort((a, b) => a.text.localeCompare(b.text));
                lbFunctions.innerHTML = '';
                options.forEach(option => {
                    let opt = document.createElement('option');
                    opt.value = option.value;
                    opt.text = option.text;
                    lbFunctions.appendChild(opt);
                });
            }
        }

        // Egyéni függvények futtatása sorban
        function runCustomFunctions() {
            let input = document.getElementById('InputBox').value;
            const lbCustom = document.getElementById('LB_CustomFunction');
            for (let i = 0; i < lbCustom.options.length; i++) {
                const fnName = lbCustom.options[i].value;
                if (functionMap[fnName]) {
                    input = functionMap[fnName](input);
                }
            }
            document.getElementById('OutputBox').value = input;
        }

        // A már meglévő gombokhoz tartozó függvények (változatlanul)
        function toUpperCase() {
            const inputText = document.getElementById('InputBox').value;
            document.getElementById('OutputBox').value = inputText.toUpperCase();
        }
        
        function toLowerCase() {
            const inputText = document.getElementById('InputBox').value;
            document.getElementById('OutputBox').value = inputText.toLowerCase();
        }
        
        function capitalizeFirst() {
            const inputText = document.getElementById('InputBox').value;
            if (inputText.length === 0) return;
            document.getElementById('OutputBox').value = 
                inputText.charAt(0).toUpperCase() + inputText.slice(1).toLowerCase();
        }
        
        function reverseText() {
            const inputText = document.getElementById('InputBox').value;
            document.getElementById('OutputBox').value = inputText.split('').reverse().join('');
        }

        function stringToStringArray() {
            let inputText = document.getElementById('InputBox').value;
            inputText = inputText.replace(/`/g, '');
            inputText = inputText.replace(/'/g, "''");
            let lines = inputText.split(/\r?\n/);
            lines = lines.map(line => `'${line}'`);
            for (let i = 0; i < lines.length - 1; i++) {
                lines[i] = lines[i] + ',';
            }
            document.getElementById('OutputBox').value = lines.join('\n');
        }

        function stringArrayToString() {
            let inputText = document.getElementById('InputBox').value;
            let lines = inputText.split(/\r?\n/);
            lines = lines.map(line => line.replace(/,$/, ''));
            lines = lines.map(line => line.replace(/^'+|'+$/g, ''));
            lines = lines.map(line => line.replace(/''/g, "'"));
            document.getElementById('OutputBox').value = lines.join('\n');
        }

        function linebreakToComma() {
            let inputText = document.getElementById('InputBox').value;
            let lines = inputText.split(/\r?\n/).map(line => line.trim()).filter(line => line.length > 0);
            const result = lines.join(',');
            document.getElementById('OutputBox').value = result;
        }

        function linebreakToCommaAddQuoteStr() {
            let inputText = document.getElementById('InputBox').value;
            let lines = inputText.split(/\r?\n/).map(line => line.trim()).filter(line => line.length > 0);
            lines = lines.map(line => `'${line}'`);
            const result = lines.join(',');
            document.getElementById('OutputBox').value = result;
        }
        // Később további funkciókat lehet itt hozzáadni
    </script>
</body>
</html>